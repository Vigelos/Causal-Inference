<html><head></head><body><link rel="stylesheet" type="text/css" href="chrome-extension://ckkdlimhmcjmikdlpkmbgfkaikojcbjk/themes/github.css" id="_theme"><div id="_html" class="markdown-body"><h1 id="a-blog-to-introduce-you-to-the-basic-theory-of-causal-inferencei"><a class="anchor" name="a-blog-to-introduce-you-to-the-basic-theory-of-causal-inferencei" href="#a-blog-to-introduce-you-to-the-basic-theory-of-causal-inferencei"><span class="octicon octicon-link"></span></a>A blog to introduce you to the basic theory of causal inference(I)</h1>
<p><font size="2">Causal Inference has recently become a hot 
topic to improve the result of many previous methods 
in the area of machine learning, receiving considerable 
feedback. However, the whole system of causal inference 
may seem not so easy for new-comers to get start. So this 
blog is to introduce the basic theory of Causal Inference 
as simply as possible but meanwhile keeps the structure clear.</font></p>
<hr>
<h2 id="part-i--introduction"><a class="anchor" name="part-i--introduction" href="#part-i--introduction"><span class="octicon octicon-link"></span></a>Part I : Introduction</h2>
<h3 id="1-what-is-causal"><a class="anchor" name="1-what-is-causal" href="#1-what-is-causal"><span class="octicon octicon-link"></span></a>1. What is causal?</h3>
<p>It seems a stupid question since everyone can simply 
answer, but, the <strong>causal</strong> relation mentioned this blog 
may different slightly from what <strong>causal</strong> means in our 
daily life. </p>
<p>Let me introduce some terms first:</p>
<pre class=" language-html"><code class=" language-html">Relation:  Causation / Association
Operation: Observation(Condition) / Intervention</code></pre>
<br>

<h4 id="causation："><a class="anchor" name="causation：" href="#causation："><span class="octicon octicon-link"></span></a>Causation：</h4>
<p>The change of <strong>cause</strong> will lead to the change of <strong>result</strong>.</p>
<pre class=" language-mermaid"><code class=" language-mermaid" data-processed="true"><svg id="mermaid-1632534169587" width="100%" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" height="58.66666793823242" style="max-width: 201.33334350585938px;" viewBox="0 0 201.33334350585938 58.66666793823242"><style>#mermaid-1632534169587{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;fill:#333;}#mermaid-1632534169587 .error-icon{fill:#552222;}#mermaid-1632534169587 .error-text{fill:#552222;stroke:#552222;}#mermaid-1632534169587 .edge-thickness-normal{stroke-width:2px;}#mermaid-1632534169587 .edge-thickness-thick{stroke-width:3.5px;}#mermaid-1632534169587 .edge-pattern-solid{stroke-dasharray:0;}#mermaid-1632534169587 .edge-pattern-dashed{stroke-dasharray:3;}#mermaid-1632534169587 .edge-pattern-dotted{stroke-dasharray:2;}#mermaid-1632534169587 .marker{fill:#333333;}#mermaid-1632534169587 .marker.cross{stroke:#333333;}#mermaid-1632534169587 svg{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;}#mermaid-1632534169587 .label{font-family:"trebuchet ms",verdana,arial,sans-serif;color:#333;}#mermaid-1632534169587 .label text{fill:#333;}#mermaid-1632534169587 .node rect,#mermaid-1632534169587 .node circle,#mermaid-1632534169587 .node ellipse,#mermaid-1632534169587 .node polygon,#mermaid-1632534169587 .node path{fill:#ECECFF;stroke:#9370DB;stroke-width:1px;}#mermaid-1632534169587 .node .label{text-align:center;}#mermaid-1632534169587 .node.clickable{cursor:pointer;}#mermaid-1632534169587 .arrowheadPath{fill:#333333;}#mermaid-1632534169587 .edgePath .path{stroke:#333333;stroke-width:1.5px;}#mermaid-1632534169587 .flowchart-link{stroke:#333333;fill:none;}#mermaid-1632534169587 .edgeLabel{background-color:#e8e8e8;text-align:center;}#mermaid-1632534169587 .edgeLabel rect{opacity:0.5;background-color:#e8e8e8;fill:#e8e8e8;}#mermaid-1632534169587 .cluster rect{fill:#ffffde;stroke:#aaaa33;stroke-width:1px;}#mermaid-1632534169587 .cluster text{fill:#333;}#mermaid-1632534169587 div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:12px;background:hsl(80,100%,96.2745098039%);border:1px solid #aaaa33;border-radius:2px;pointer-events:none;z-index:100;}#mermaid-1632534169587:root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif;}#mermaid-1632534169587 flowchart{fill:apa;}</style><g><g class="output"><g class="clusters"></g><g class="edgePaths"><g class="edgePath LS-A LE-B" id="L-A-B" style="opacity: 1;"><path class="path" d="M50.66666793823242,29.33333396911621L75.66666793823242,29.33333396911621L100.66666793823242,29.33333396911621L125.66666793823242,29.33333396911621L150.66666793823242,29.33333396911621" marker-end="url(#arrowhead13)" style="fill:none"></path><defs><marker id="arrowhead13" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g></g><g class="edgeLabels"><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-A-B" class="edgeLabel L-LS-A' L-LE-B"></span></div></foreignObject></g></g></g><g class="nodes"><g class="node default" id="flowchart-A-2" transform="translate(29.33333396911621,29.33333396911621)" style="opacity: 1;"><circle x="-14.71875" y="-21.33333396911621" r="21.33333396911621" class="label-container"></circle><g class="label" transform="translate(0,0)"><g transform="translate(-4.71875,-11.333333969116211)"><foreignObject width="9.4375" height="22.666667938232422"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">A</div></foreignObject></g></g></g><g class="node default" id="flowchart-B-3" transform="translate(172.00000190734863,29.33333396911621)" style="opacity: 1;"><circle x="-14.53125" y="-21.33333396911621" r="21.33333396911621" class="label-container"></circle><g class="label" transform="translate(0,0)"><g transform="translate(-4.53125,-11.333333969116211)"><foreignObject width="9.0625" height="22.666667938232422"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">B</div></foreignObject></g></g></g></g></g></g></svg></code></pre>
<p><font size="2">(A: body temperature &nbsp; &nbsp;B: thermometer)</font>
<br><br>
Empirically, we can simply figure out that it is the change
in body temperature that leads to different readings on the 
thermometer. In this case, A is <strong>independent variable</strong> and 
B is <strong>dependent variable</strong>, which will change correspondingly
on A changed.</p>
<br>

<h4 id="association"><a class="anchor" name="association" href="#association"><span class="octicon octicon-link"></span></a>Association:</h4>
<p>Variables statistically dependent.<br></p>
<pre class=" language-mermaid"><code class=" language-mermaid" data-processed="true"><svg id="mermaid-1632534169600" width="100%" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" height="58.66666793823242" style="max-width: 251.33334350585938px;" viewBox="0 0 251.33334350585938 58.66666793823242"><style>#mermaid-1632534169600{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;fill:#333;}#mermaid-1632534169600 .error-icon{fill:#552222;}#mermaid-1632534169600 .error-text{fill:#552222;stroke:#552222;}#mermaid-1632534169600 .edge-thickness-normal{stroke-width:2px;}#mermaid-1632534169600 .edge-thickness-thick{stroke-width:3.5px;}#mermaid-1632534169600 .edge-pattern-solid{stroke-dasharray:0;}#mermaid-1632534169600 .edge-pattern-dashed{stroke-dasharray:3;}#mermaid-1632534169600 .edge-pattern-dotted{stroke-dasharray:2;}#mermaid-1632534169600 .marker{fill:#333333;}#mermaid-1632534169600 .marker.cross{stroke:#333333;}#mermaid-1632534169600 svg{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;}#mermaid-1632534169600 .label{font-family:"trebuchet ms",verdana,arial,sans-serif;color:#333;}#mermaid-1632534169600 .label text{fill:#333;}#mermaid-1632534169600 .node rect,#mermaid-1632534169600 .node circle,#mermaid-1632534169600 .node ellipse,#mermaid-1632534169600 .node polygon,#mermaid-1632534169600 .node path{fill:#ECECFF;stroke:#9370DB;stroke-width:1px;}#mermaid-1632534169600 .node .label{text-align:center;}#mermaid-1632534169600 .node.clickable{cursor:pointer;}#mermaid-1632534169600 .arrowheadPath{fill:#333333;}#mermaid-1632534169600 .edgePath .path{stroke:#333333;stroke-width:1.5px;}#mermaid-1632534169600 .flowchart-link{stroke:#333333;fill:none;}#mermaid-1632534169600 .edgeLabel{background-color:#e8e8e8;text-align:center;}#mermaid-1632534169600 .edgeLabel rect{opacity:0.5;background-color:#e8e8e8;fill:#e8e8e8;}#mermaid-1632534169600 .cluster rect{fill:#ffffde;stroke:#aaaa33;stroke-width:1px;}#mermaid-1632534169600 .cluster text{fill:#333;}#mermaid-1632534169600 div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:12px;background:hsl(80,100%,96.2745098039%);border:1px solid #aaaa33;border-radius:2px;pointer-events:none;z-index:100;}#mermaid-1632534169600:root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif;}#mermaid-1632534169600 flowchart{fill:apa;}</style><g><g class="output"><g class="clusters"></g><g class="edgePaths"><g class="edgePath LS-B LE-C" id="L-B-C" style="opacity: 1;"><path class="path" d="M50.18651042338177,24.832648465205487L75.66666793823242,19.33333396911621L100.66666793823242,19.33333396911621L125.66666793823242,19.33333396911621L150.66666793823242,19.33333396911621L175.66666793823242,19.33333396911621L201.14682545308307,24.832648465205487" marker-end="url(#arrowhead38)" style="fill:none"></path><defs><marker id="arrowhead38" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-C LE-B" id="L-C-B" style="opacity: 1;"><path class="path" d="M201.14682545308307,33.834019473026935L175.66666793823242,39.33333396911621L150.66666793823242,39.33333396911621L125.66666793823242,39.33333396911621L100.66666793823242,39.33333396911621L75.66666793823242,39.33333396911621L50.18651042338177,33.834019473026935" marker-end="url(#arrowhead39)" style="fill:none"></path><defs><marker id="arrowhead39" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g></g><g class="edgeLabels"><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-B-C" class="edgeLabel L-LS-B' L-LE-C"></span></div></foreignObject></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-C-B" class="edgeLabel L-LS-C' L-LE-B"></span></div></foreignObject></g></g></g><g class="nodes"><g class="node default" id="flowchart-B-10" transform="translate(29.33333396911621,29.33333396911621)" style="opacity: 1;"><circle x="-15.390625" y="-21.33333396911621" r="21.33333396911621" class="label-container"></circle><g class="label" transform="translate(0,0)"><g transform="translate(-5.390625,-11.333333969116211)"><foreignObject width="10.78125" height="22.666667938232422"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">O</div></foreignObject></g></g></g><g class="node default" id="flowchart-C-11" transform="translate(222.00000190734863,29.33333396911621)" style="opacity: 1;"><circle x="-15.234375" y="-21.33333396911621" r="21.33333396911621" class="label-container"></circle><g class="label" transform="translate(0,0)"><g transform="translate(-5.234375,-11.333333969116211)"><foreignObject width="10.46875" height="22.666667938232422"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">H</div></foreignObject></g></g></g></g></g></g></svg></code></pre>
<p><font size="2">(O: oil price &nbsp;&nbsp; H: house price)</font></p>
<p>We may often see that the house price in a country where 
the oil price is high will also be considerably high, and 
if the house price is dropping quickly, we are likely to
predict that the oil price will also be dropping. <strong>The 
two variables are highly dependent in statistics data.</strong> 
<br><br>
But, it is absurd to conclude that the change in the oil price 
accounts for the change in the house price. Actually, <strong>inflation
caused both oil price and house price to rise</strong>. It made us
cheated by the phenomenon and <strong>misunderstand the association 
relation between oil price and house price as causal 
association</strong>. So, later in this blog, we will refer to variables 
of this type as <strong><em>confounder</em></strong>.</p>
<pre class=" language-mermaid"><code class=" language-mermaid" data-processed="true"><svg id="mermaid-1632534169610" width="100%" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" height="151.3333282470703" style="max-width: 151.3333282470703px;" viewBox="0 0 151.3333282470703 151.3333282470703"><style>#mermaid-1632534169610{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;fill:#333;}#mermaid-1632534169610 .error-icon{fill:#552222;}#mermaid-1632534169610 .error-text{fill:#552222;stroke:#552222;}#mermaid-1632534169610 .edge-thickness-normal{stroke-width:2px;}#mermaid-1632534169610 .edge-thickness-thick{stroke-width:3.5px;}#mermaid-1632534169610 .edge-pattern-solid{stroke-dasharray:0;}#mermaid-1632534169610 .edge-pattern-dashed{stroke-dasharray:3;}#mermaid-1632534169610 .edge-pattern-dotted{stroke-dasharray:2;}#mermaid-1632534169610 .marker{fill:#333333;}#mermaid-1632534169610 .marker.cross{stroke:#333333;}#mermaid-1632534169610 svg{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;}#mermaid-1632534169610 .label{font-family:"trebuchet ms",verdana,arial,sans-serif;color:#333;}#mermaid-1632534169610 .label text{fill:#333;}#mermaid-1632534169610 .node rect,#mermaid-1632534169610 .node circle,#mermaid-1632534169610 .node ellipse,#mermaid-1632534169610 .node polygon,#mermaid-1632534169610 .node path{fill:#ECECFF;stroke:#9370DB;stroke-width:1px;}#mermaid-1632534169610 .node .label{text-align:center;}#mermaid-1632534169610 .node.clickable{cursor:pointer;}#mermaid-1632534169610 .arrowheadPath{fill:#333333;}#mermaid-1632534169610 .edgePath .path{stroke:#333333;stroke-width:1.5px;}#mermaid-1632534169610 .flowchart-link{stroke:#333333;fill:none;}#mermaid-1632534169610 .edgeLabel{background-color:#e8e8e8;text-align:center;}#mermaid-1632534169610 .edgeLabel rect{opacity:0.5;background-color:#e8e8e8;fill:#e8e8e8;}#mermaid-1632534169610 .cluster rect{fill:#ffffde;stroke:#aaaa33;stroke-width:1px;}#mermaid-1632534169610 .cluster text{fill:#333;}#mermaid-1632534169610 div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:12px;background:hsl(80,100%,96.2745098039%);border:1px solid #aaaa33;border-radius:2px;pointer-events:none;z-index:100;}#mermaid-1632534169610:root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif;}#mermaid-1632534169610 flowchart{fill:apa;}</style><g><g class="output"><g class="clusters"></g><g class="edgePaths"><g class="edgePath LS-A LE-B" id="L-A-B" style="opacity: 1;"><path class="path" d="M60.581722823353026,44.41827908399561L29.33333396911621,75.66666793823242L29.33333396911621,100.66666793823242" marker-end="url(#arrowhead47)" style="fill:none"></path><defs><marker id="arrowhead47" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-A LE-C" id="L-A-C" style="opacity: 1;"><path class="path" d="M90.75161305311183,44.41827908399561L122.00000190734863,75.66666793823242L122.00000190734863,100.66666793823242" marker-end="url(#arrowhead48)" style="fill:none"></path><defs><marker id="arrowhead48" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g></g><g class="edgeLabels"><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-A-B" class="edgeLabel L-LS-A' L-LE-B"></span></div></foreignObject></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-A-C" class="edgeLabel L-LS-A' L-LE-C"></span></div></foreignObject></g></g></g><g class="nodes"><g class="node default" id="flowchart-A-23" transform="translate(75.66666793823242,29.33333396911621)" style="opacity: 1;"><circle x="-12.229166746139526" y="-21.33333396911621" r="21.33333396911621" class="label-container"></circle><g class="label" transform="translate(0,0)"><g transform="translate(-2.2291667461395264,-11.333333969116211)"><foreignObject width="4.458333492279053" height="22.666667938232422"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">I</div></foreignObject></g></g></g><g class="node default" id="flowchart-B-24" transform="translate(29.33333396911621,122.00000190734863)" style="opacity: 1;"><circle x="-15.390625" y="-21.33333396911621" r="21.33333396911621" class="label-container"></circle><g class="label" transform="translate(0,0)"><g transform="translate(-5.390625,-11.333333969116211)"><foreignObject width="10.78125" height="22.666667938232422"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">O</div></foreignObject></g></g></g><g class="node default" id="flowchart-C-25" transform="translate(122.00000190734863,122.00000190734863)" style="opacity: 1;"><circle x="-15.234375" y="-21.33333396911621" r="21.33333396911621" class="label-container"></circle><g class="label" transform="translate(0,0)"><g transform="translate(-5.234375,-11.333333969116211)"><foreignObject width="10.46875" height="22.666667938232422"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">H</div></foreignObject></g></g></g></g></g></g></svg></code></pre>
<p><font size="2">(I: inflation &nbsp;&nbsp;  O: oil price &nbsp;&nbsp;  H: house price)</font></p>
<br>

<h4 id="observationcondition"><a class="anchor" name="observationcondition" href="#observationcondition"><span class="octicon octicon-link"></span></a>Observation(Condition):</h4>
<p>Observation means directly get the data from the raw statistics 
data and then use it as <strong>prior knowledge</strong> to predict other
variables. For example, if given an unknown thermometer, we
would predict the reading by randomly guess but if we observe
that the patient has caught a fever, we would likely guess 
the reading is at about 39'C.<br></p>
<p>As described above, observation on the independent variable 
will lead to the change in our prediction on the dependent
variable(P(y)!=P(y|x)). Actually, observation will affect
it's counterpart in all relationships:<br></p>
<pre class=" language-mermaid"><code class=" language-mermaid" data-processed="true"><svg id="mermaid-1632534169621" width="100%" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" height="151.3333282470703" style="max-width: 251.33334350585938px;" viewBox="0 0 251.33334350585938 151.3333282470703"><style>#mermaid-1632534169621{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;fill:#333;}#mermaid-1632534169621 .error-icon{fill:#552222;}#mermaid-1632534169621 .error-text{fill:#552222;stroke:#552222;}#mermaid-1632534169621 .edge-thickness-normal{stroke-width:2px;}#mermaid-1632534169621 .edge-thickness-thick{stroke-width:3.5px;}#mermaid-1632534169621 .edge-pattern-solid{stroke-dasharray:0;}#mermaid-1632534169621 .edge-pattern-dashed{stroke-dasharray:3;}#mermaid-1632534169621 .edge-pattern-dotted{stroke-dasharray:2;}#mermaid-1632534169621 .marker{fill:#333333;}#mermaid-1632534169621 .marker.cross{stroke:#333333;}#mermaid-1632534169621 svg{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;}#mermaid-1632534169621 .label{font-family:"trebuchet ms",verdana,arial,sans-serif;color:#333;}#mermaid-1632534169621 .label text{fill:#333;}#mermaid-1632534169621 .node rect,#mermaid-1632534169621 .node circle,#mermaid-1632534169621 .node ellipse,#mermaid-1632534169621 .node polygon,#mermaid-1632534169621 .node path{fill:#ECECFF;stroke:#9370DB;stroke-width:1px;}#mermaid-1632534169621 .node .label{text-align:center;}#mermaid-1632534169621 .node.clickable{cursor:pointer;}#mermaid-1632534169621 .arrowheadPath{fill:#333333;}#mermaid-1632534169621 .edgePath .path{stroke:#333333;stroke-width:1.5px;}#mermaid-1632534169621 .flowchart-link{stroke:#333333;fill:none;}#mermaid-1632534169621 .edgeLabel{background-color:#e8e8e8;text-align:center;}#mermaid-1632534169621 .edgeLabel rect{opacity:0.5;background-color:#e8e8e8;fill:#e8e8e8;}#mermaid-1632534169621 .cluster rect{fill:#ffffde;stroke:#aaaa33;stroke-width:1px;}#mermaid-1632534169621 .cluster text{fill:#333;}#mermaid-1632534169621 div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:12px;background:hsl(80,100%,96.2745098039%);border:1px solid #aaaa33;border-radius:2px;pointer-events:none;z-index:100;}#mermaid-1632534169621:root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif;}#mermaid-1632534169621 flowchart{fill:apa;}</style><g><g class="output"><g class="clusters"></g><g class="edgePaths"><g class="edgePath LS-A1 LE-A2" id="L-A1-A2" style="opacity: 1;"><path class="path" d="M50.18651042338177,24.832648465205487L75.66666793823242,19.33333396911621L100.66666793823242,19.33333396911621L125.66666793823242,19.33333396911621L150.66666793823242,19.33333396911621L175.66666793823242,19.33333396911621L201.14682545308307,24.832648465205487" marker-end="url(#arrowhead78)" style="fill:none"></path><defs><marker id="arrowhead78" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-A2 LE-A1" id="L-A2-A1" style="opacity: 1;"><path class="path" d="M205.2126453192672,42.49752012027826L175.66666793823242,65.66666793823242L150.66666793823242,65.66666793823242L125.66666793823242,65.66666793823242L100.66666793823242,65.66666793823242L75.66666793823242,65.66666793823242L46.12069055719764,42.49752012027826" marker-end="url(#arrowhead79)" style="fill:none"></path><defs><marker id="arrowhead79" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-I LE-D" id="L-I-D" style="opacity: 1;"><path class="path" d="M50.66666793823242,122.00000190734863L75.66666793823242,122.00000190734863L100.66666793823242,122.00000190734863L125.66666793823242,122.00000190734863L150.66666793823242,122.00000190734863L175.66666793823242,122.00000190734863L200.66666793823242,122.00000190734863" marker-end="url(#arrowhead80)" style="fill:none"></path><defs><marker id="arrowhead80" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g></g><g class="edgeLabels"><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-A1-A2" class="edgeLabel L-LS-A1' L-LE-A2"></span></div></foreignObject></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-A2-A1" class="edgeLabel L-LS-A2' L-LE-A1"></span></div></foreignObject></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-I-D" class="edgeLabel L-LS-I' L-LE-D"></span></div></foreignObject></g></g></g><g class="nodes"><g class="node default" id="flowchart-A1-40" transform="translate(29.33333396911621,29.33333396911621)" style="opacity: 1;"><circle x="-18.916666984558105" y="-21.33333396911621" r="21.33333396911621" class="label-container"></circle><g class="label" transform="translate(0,0)"><g transform="translate(-8.916666984558105,-11.333333969116211)"><foreignObject width="17.83333396911621" height="22.666667938232422"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">A1</div></foreignObject></g></g></g><g class="node default" id="flowchart-A2-41" transform="translate(222.00000190734863,29.33333396911621)" style="opacity: 1;"><circle x="-18.916666984558105" y="-21.33333396911621" r="21.33333396911621" class="label-container"></circle><g class="label" transform="translate(0,0)"><g transform="translate(-8.916666984558105,-11.333333969116211)"><foreignObject width="17.83333396911621" height="22.666667938232422"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">A2</div></foreignObject></g></g></g><g class="node default" id="flowchart-I-42" transform="translate(29.33333396911621,122.00000190734863)" style="opacity: 1;"><circle x="-12.229166746139526" y="-21.33333396911621" r="21.33333396911621" class="label-container"></circle><g class="label" transform="translate(0,0)"><g transform="translate(-2.2291667461395264,-11.333333969116211)"><foreignObject width="4.458333492279053" height="22.666667938232422"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">I</div></foreignObject></g></g></g><g class="node default" id="flowchart-D-43" transform="translate(222.00000190734863,122.00000190734863)" style="opacity: 1;"><circle x="-14.90625" y="-21.33333396911621" r="21.33333396911621" class="label-container"></circle><g class="label" transform="translate(0,0)"><g transform="translate(-4.90625,-11.333333969116211)"><foreignObject width="9.8125" height="22.666667938232422"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">D</div></foreignObject></g></g></g></g></g></g></svg></code></pre>
<pre class=" language-html"><code class=" language-html">P(A1) != P(A1 | A2)
P(A2) != P(A2 | A1)
P(I)  != P(I | D)
P(D)  != P(D | I)

(A1,A2: Two associated variables in association 
I: Independent variable in causation
D: Dependent variable in causation)</code></pre>
<br>

<h4 id="intervention"><a class="anchor" name="intervention" href="#intervention"><span class="octicon octicon-link"></span></a>Intervention</h4>
<p>Intervention means manually changed a variable to a certain
value, for example: if we want to find whether regular exercise
contributes to a higher grade, we assume that regular exercise
has causal effect on good grades:</p>
<pre class=" language-mermaid"><code class=" language-mermaid" data-processed="true"><svg id="mermaid-1632534169635" width="100%" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" height="58.66666793823242" style="max-width: 251.33334350585938px;" viewBox="0 0 251.33334350585938 58.66666793823242"><style>#mermaid-1632534169635{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;fill:#333;}#mermaid-1632534169635 .error-icon{fill:#552222;}#mermaid-1632534169635 .error-text{fill:#552222;stroke:#552222;}#mermaid-1632534169635 .edge-thickness-normal{stroke-width:2px;}#mermaid-1632534169635 .edge-thickness-thick{stroke-width:3.5px;}#mermaid-1632534169635 .edge-pattern-solid{stroke-dasharray:0;}#mermaid-1632534169635 .edge-pattern-dashed{stroke-dasharray:3;}#mermaid-1632534169635 .edge-pattern-dotted{stroke-dasharray:2;}#mermaid-1632534169635 .marker{fill:#333333;}#mermaid-1632534169635 .marker.cross{stroke:#333333;}#mermaid-1632534169635 svg{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;}#mermaid-1632534169635 .label{font-family:"trebuchet ms",verdana,arial,sans-serif;color:#333;}#mermaid-1632534169635 .label text{fill:#333;}#mermaid-1632534169635 .node rect,#mermaid-1632534169635 .node circle,#mermaid-1632534169635 .node ellipse,#mermaid-1632534169635 .node polygon,#mermaid-1632534169635 .node path{fill:#ECECFF;stroke:#9370DB;stroke-width:1px;}#mermaid-1632534169635 .node .label{text-align:center;}#mermaid-1632534169635 .node.clickable{cursor:pointer;}#mermaid-1632534169635 .arrowheadPath{fill:#333333;}#mermaid-1632534169635 .edgePath .path{stroke:#333333;stroke-width:1.5px;}#mermaid-1632534169635 .flowchart-link{stroke:#333333;fill:none;}#mermaid-1632534169635 .edgeLabel{background-color:#e8e8e8;text-align:center;}#mermaid-1632534169635 .edgeLabel rect{opacity:0.5;background-color:#e8e8e8;fill:#e8e8e8;}#mermaid-1632534169635 .cluster rect{fill:#ffffde;stroke:#aaaa33;stroke-width:1px;}#mermaid-1632534169635 .cluster text{fill:#333;}#mermaid-1632534169635 div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:12px;background:hsl(80,100%,96.2745098039%);border:1px solid #aaaa33;border-radius:2px;pointer-events:none;z-index:100;}#mermaid-1632534169635:root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif;}#mermaid-1632534169635 flowchart{fill:apa;}</style><g><g class="output"><g class="clusters"></g><g class="edgePaths"><g class="edgePath LS-E LE-G" id="L-E-G" style="opacity: 1;"><path class="path" d="M50.66666793823242,29.33333396911621L75.66666793823242,29.33333396911621L100.66666793823242,29.33333396911621L125.66666793823242,29.33333396911621L150.66666793823242,29.33333396911621L175.66666793823242,29.33333396911621L200.66666793823242,29.33333396911621" marker-end="url(#arrowhead99)" style="fill:none"></path><defs><marker id="arrowhead99" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g></g><g class="edgeLabels"><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-E-G" class="edgeLabel L-LS-E' L-LE-G"></span></div></foreignObject></g></g></g><g class="nodes"><g class="node default" id="flowchart-E-54" transform="translate(29.33333396911621,29.33333396911621)" style="opacity: 1;"><circle x="-14.286458492279053" y="-21.33333396911621" r="21.33333396911621" class="label-container"></circle><g class="label" transform="translate(0,0)"><g transform="translate(-4.286458492279053,-11.333333969116211)"><foreignObject width="8.572916984558105" height="22.666667938232422"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">E</div></foreignObject></g></g></g><g class="node default" id="flowchart-G-55" transform="translate(222.00000190734863,29.33333396911621)" style="opacity: 1;"><circle x="-15.411458492279053" y="-21.33333396911621" r="21.33333396911621" class="label-container"></circle><g class="label" transform="translate(0,0)"><g transform="translate(-5.411458492279053,-11.333333969116211)"><foreignObject width="10.822916984558105" height="22.666667938232422"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">G</div></foreignObject></g></g></g></g></g></g></svg></code></pre>
<p><font size="2">(E: regular exercise &nbsp;&nbsp; G: good grades)</font></p>
<p>To prove our assumption, <strong>we command that all students in 
our school must exercise regularly</strong>, and then we surprisingly 
found that the grades of all students has been improved,
which means regular exercise do have causal effect on 
a good grade.</p>
<p>In this case, we use <strong>do(E=e) or do(e)</strong> to denote that we
<strong>intervened</strong> on variable E(exercise condition). We change
the variable E of all the students in our school to e(regular exercise)
irrespective of whether the student's exercise condition
is originally regular or irregular if there hadn't been our
experiment.</p>
<br>

<p>Unlike <strong>condition</strong> mentioned above, <strong>intervention</strong> only 
effects the dependent variable as independent variable in 
causal association:</p>
<pre class=" language-mermaid"><code class=" language-mermaid" data-processed="true"><svg id="mermaid-1632534169646" width="100%" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" height="151.3333282470703" style="max-width: 251.33334350585938px;" viewBox="0 0 251.33334350585938 151.3333282470703"><style>#mermaid-1632534169646{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;fill:#333;}#mermaid-1632534169646 .error-icon{fill:#552222;}#mermaid-1632534169646 .error-text{fill:#552222;stroke:#552222;}#mermaid-1632534169646 .edge-thickness-normal{stroke-width:2px;}#mermaid-1632534169646 .edge-thickness-thick{stroke-width:3.5px;}#mermaid-1632534169646 .edge-pattern-solid{stroke-dasharray:0;}#mermaid-1632534169646 .edge-pattern-dashed{stroke-dasharray:3;}#mermaid-1632534169646 .edge-pattern-dotted{stroke-dasharray:2;}#mermaid-1632534169646 .marker{fill:#333333;}#mermaid-1632534169646 .marker.cross{stroke:#333333;}#mermaid-1632534169646 svg{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;}#mermaid-1632534169646 .label{font-family:"trebuchet ms",verdana,arial,sans-serif;color:#333;}#mermaid-1632534169646 .label text{fill:#333;}#mermaid-1632534169646 .node rect,#mermaid-1632534169646 .node circle,#mermaid-1632534169646 .node ellipse,#mermaid-1632534169646 .node polygon,#mermaid-1632534169646 .node path{fill:#ECECFF;stroke:#9370DB;stroke-width:1px;}#mermaid-1632534169646 .node .label{text-align:center;}#mermaid-1632534169646 .node.clickable{cursor:pointer;}#mermaid-1632534169646 .arrowheadPath{fill:#333333;}#mermaid-1632534169646 .edgePath .path{stroke:#333333;stroke-width:1.5px;}#mermaid-1632534169646 .flowchart-link{stroke:#333333;fill:none;}#mermaid-1632534169646 .edgeLabel{background-color:#e8e8e8;text-align:center;}#mermaid-1632534169646 .edgeLabel rect{opacity:0.5;background-color:#e8e8e8;fill:#e8e8e8;}#mermaid-1632534169646 .cluster rect{fill:#ffffde;stroke:#aaaa33;stroke-width:1px;}#mermaid-1632534169646 .cluster text{fill:#333;}#mermaid-1632534169646 div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:12px;background:hsl(80,100%,96.2745098039%);border:1px solid #aaaa33;border-radius:2px;pointer-events:none;z-index:100;}#mermaid-1632534169646:root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif;}#mermaid-1632534169646 flowchart{fill:apa;}</style><g><g class="output"><g class="clusters"></g><g class="edgePaths"><g class="edgePath LS-A1 LE-A2" id="L-A1-A2" style="opacity: 1;"><path class="path" d="M50.18651042338177,24.832648465205487L75.66666793823242,19.33333396911621L100.66666793823242,19.33333396911621L125.66666793823242,19.33333396911621L150.66666793823242,19.33333396911621L175.66666793823242,19.33333396911621L201.14682545308307,24.832648465205487" marker-end="url(#arrowhead129)" style="fill:none"></path><defs><marker id="arrowhead129" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-A2 LE-A1" id="L-A2-A1" style="opacity: 1;"><path class="path" d="M205.2126453192672,42.49752012027826L175.66666793823242,65.66666793823242L150.66666793823242,65.66666793823242L125.66666793823242,65.66666793823242L100.66666793823242,65.66666793823242L75.66666793823242,65.66666793823242L46.12069055719764,42.49752012027826" marker-end="url(#arrowhead130)" style="fill:none"></path><defs><marker id="arrowhead130" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-I LE-D" id="L-I-D" style="opacity: 1;"><path class="path" d="M50.66666793823242,122.00000190734863L75.66666793823242,122.00000190734863L100.66666793823242,122.00000190734863L125.66666793823242,122.00000190734863L150.66666793823242,122.00000190734863L175.66666793823242,122.00000190734863L200.66666793823242,122.00000190734863" marker-end="url(#arrowhead131)" style="fill:none"></path><defs><marker id="arrowhead131" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g></g><g class="edgeLabels"><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-A1-A2" class="edgeLabel L-LS-A1' L-LE-A2"></span></div></foreignObject></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-A2-A1" class="edgeLabel L-LS-A2' L-LE-A1"></span></div></foreignObject></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-I-D" class="edgeLabel L-LS-I' L-LE-D"></span></div></foreignObject></g></g></g><g class="nodes"><g class="node default" id="flowchart-A1-68" transform="translate(29.33333396911621,29.33333396911621)" style="opacity: 1;"><circle x="-18.916666984558105" y="-21.33333396911621" r="21.33333396911621" class="label-container"></circle><g class="label" transform="translate(0,0)"><g transform="translate(-8.916666984558105,-11.333333969116211)"><foreignObject width="17.83333396911621" height="22.666667938232422"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">A1</div></foreignObject></g></g></g><g class="node default" id="flowchart-A2-69" transform="translate(222.00000190734863,29.33333396911621)" style="opacity: 1;"><circle x="-18.916666984558105" y="-21.33333396911621" r="21.33333396911621" class="label-container"></circle><g class="label" transform="translate(0,0)"><g transform="translate(-8.916666984558105,-11.333333969116211)"><foreignObject width="17.83333396911621" height="22.666667938232422"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">A2</div></foreignObject></g></g></g><g class="node default" id="flowchart-I-70" transform="translate(29.33333396911621,122.00000190734863)" style="opacity: 1;"><circle x="-12.229166746139526" y="-21.33333396911621" r="21.33333396911621" class="label-container"></circle><g class="label" transform="translate(0,0)"><g transform="translate(-2.2291667461395264,-11.333333969116211)"><foreignObject width="4.458333492279053" height="22.666667938232422"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">I</div></foreignObject></g></g></g><g class="node default" id="flowchart-D-71" transform="translate(222.00000190734863,122.00000190734863)" style="opacity: 1;"><circle x="-14.90625" y="-21.33333396911621" r="21.33333396911621" class="label-container"></circle><g class="label" transform="translate(0,0)"><g transform="translate(-4.90625,-11.333333969116211)"><foreignObject width="9.8125" height="22.666667938232422"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">D</div></foreignObject></g></g></g></g></g></g></svg></code></pre>
<pre class=" language-html"><code class=" language-html">P(A1) = P(A1 | do(A2=a2))
P(A2) = P(A2 | do(A1=a1))
P(I)  = P(I | do(D=d))
P(D)  != P(D | do(I=i))

(A1,A2: Two associated variables in association 
I: Independent variable in causation
D: Dependent variable in causation)</code></pre>
<br>

<h3 id="2-why-causal-inference-important"><a class="anchor" name="2-why-causal-inference-important" href="#2-why-causal-inference-important"><span class="octicon octicon-link"></span></a>2. Why causal inference important?</h3>
<p>Actually, most of our present methods in machine learning is
based on association, not causation. Think about the example
of iris:</p>
<table>
<thead>
<tr>
<th align="center">L1</th>
<th align="center">L2</th>
<th align="center">L3</th>
<th align="center">L4</th>
<th align="center">species</th>
</tr>
</thead>
<tbody><tr>
<td align="center">7.0</td>
<td align="center">3.2</td>
<td align="center">4.7</td>
<td align="center">1.4</td>
<td align="center">setosa</td>
</tr>
<tr>
<td align="center">6.4</td>
<td align="center">3.2</td>
<td align="center">4.5</td>
<td align="center">1.5</td>
<td align="center">setosa</td>
</tr>
<tr>
<td align="center">5.1</td>
<td align="center">3.5</td>
<td align="center">1.4</td>
<td align="center">0.2</td>
<td align="center">versicolor</td>
</tr>
<tr>
<td align="center">5.3</td>
<td align="center">3.7</td>
<td align="center">1.5</td>
<td align="center">0.2</td>
<td align="center">versicolor</td>
</tr>
<tr>
<td align="center">5.0</td>
<td align="center">3.3</td>
<td align="center">1.4</td>
<td align="center">0.2</td>
<td align="center">virginica</td>
</tr>
</tbody></table>
<p>As we have learned in many methods in machine learning,
we use the four features (L1,L2,L3,L4) to predict the species
labels. In this case, the relation between features and 
the species are <strong>association</strong>, not <strong>causation</strong>. Actually
the causal structure should be like this:</p>
<pre class=" language-mermaid"><code class=" language-mermaid" data-processed="true"><svg id="mermaid-1632534169662" width="100%" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" height="151.3333282470703" style="max-width: 151.3333282470703px;" viewBox="0 0 151.3333282470703 151.3333282470703"><style>#mermaid-1632534169662{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;fill:#333;}#mermaid-1632534169662 .error-icon{fill:#552222;}#mermaid-1632534169662 .error-text{fill:#552222;stroke:#552222;}#mermaid-1632534169662 .edge-thickness-normal{stroke-width:2px;}#mermaid-1632534169662 .edge-thickness-thick{stroke-width:3.5px;}#mermaid-1632534169662 .edge-pattern-solid{stroke-dasharray:0;}#mermaid-1632534169662 .edge-pattern-dashed{stroke-dasharray:3;}#mermaid-1632534169662 .edge-pattern-dotted{stroke-dasharray:2;}#mermaid-1632534169662 .marker{fill:#333333;}#mermaid-1632534169662 .marker.cross{stroke:#333333;}#mermaid-1632534169662 svg{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;}#mermaid-1632534169662 .label{font-family:"trebuchet ms",verdana,arial,sans-serif;color:#333;}#mermaid-1632534169662 .label text{fill:#333;}#mermaid-1632534169662 .node rect,#mermaid-1632534169662 .node circle,#mermaid-1632534169662 .node ellipse,#mermaid-1632534169662 .node polygon,#mermaid-1632534169662 .node path{fill:#ECECFF;stroke:#9370DB;stroke-width:1px;}#mermaid-1632534169662 .node .label{text-align:center;}#mermaid-1632534169662 .node.clickable{cursor:pointer;}#mermaid-1632534169662 .arrowheadPath{fill:#333333;}#mermaid-1632534169662 .edgePath .path{stroke:#333333;stroke-width:1.5px;}#mermaid-1632534169662 .flowchart-link{stroke:#333333;fill:none;}#mermaid-1632534169662 .edgeLabel{background-color:#e8e8e8;text-align:center;}#mermaid-1632534169662 .edgeLabel rect{opacity:0.5;background-color:#e8e8e8;fill:#e8e8e8;}#mermaid-1632534169662 .cluster rect{fill:#ffffde;stroke:#aaaa33;stroke-width:1px;}#mermaid-1632534169662 .cluster text{fill:#333;}#mermaid-1632534169662 div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:12px;background:hsl(80,100%,96.2745098039%);border:1px solid #aaaa33;border-radius:2px;pointer-events:none;z-index:100;}#mermaid-1632534169662:root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif;}#mermaid-1632534169662 flowchart{fill:apa;}</style><g><g class="output"><g class="clusters"></g><g class="edgePaths"><g class="edgePath LS-G LE-F" id="L-G-F" style="opacity: 1;"><path class="path" d="M60.581722823353026,44.41827908399561L29.33333396911621,75.66666793823242L29.33333396911621,100.66666793823242" marker-end="url(#arrowhead139)" style="fill:none"></path><defs><marker id="arrowhead139" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-G LE-S" id="L-G-S" style="opacity: 1;"><path class="path" d="M90.75161305311183,44.41827908399561L122.00000190734863,75.66666793823242L122.00000190734863,100.66666793823242" marker-end="url(#arrowhead140)" style="fill:none"></path><defs><marker id="arrowhead140" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g></g><g class="edgeLabels"><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-G-F" class="edgeLabel L-LS-G' L-LE-F"></span></div></foreignObject></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-G-S" class="edgeLabel L-LS-G' L-LE-S"></span></div></foreignObject></g></g></g><g class="nodes"><g class="node default" id="flowchart-F-85" transform="translate(29.33333396911621,122.00000190734863)" style="opacity: 1;"><circle x="-14.203125" y="-21.33333396911621" r="21.33333396911621" class="label-container"></circle><g class="label" transform="translate(0,0)"><g transform="translate(-4.203125,-11.333333969116211)"><foreignObject width="8.40625" height="22.666667938232422"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">F</div></foreignObject></g></g></g><g class="node default" id="flowchart-S-86" transform="translate(122.00000190734863,122.00000190734863)" style="opacity: 1;"><circle x="-13.848958492279053" y="-21.33333396911621" r="21.33333396911621" class="label-container"></circle><g class="label" transform="translate(0,0)"><g transform="translate(-3.8489584922790527,-11.333333969116211)"><foreignObject width="7.6979169845581055" height="22.666667938232422"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">S</div></foreignObject></g></g></g><g class="node default" id="flowchart-G-87" transform="translate(75.66666793823242,29.33333396911621)" style="opacity: 1;"><circle x="-15.411458492279053" y="-21.33333396911621" r="21.33333396911621" class="label-container"></circle><g class="label" transform="translate(0,0)"><g transform="translate(-5.411458492279053,-11.333333969116211)"><foreignObject width="10.822916984558105" height="22.666667938232422"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">G</div></foreignObject></g></g></g></g></g></g></svg></code></pre>
<p><font size="2">(G: gene &nbsp;&nbsp; F: features &nbsp;&nbsp; S: species)</font></p>
<p>Till now, it seems that just using association is enough, as
we can predict the species at a high accuracy on known its
features, much like predicting the house price based on the
oil price as mentioned above. So, why <strong>causal inference</strong>
needed?</p>
<p>Let's consider another example, where we want to extract
a chemical C from iris flowers, and we get the statistics
data:</p>
<table>
<thead>
<tr>
<th align="center">L1</th>
<th align="center">L2</th>
<th align="center">L3</th>
<th align="center">L4</th>
<th align="center">chemical output</th>
</tr>
</thead>
<tbody><tr>
<td align="center">7.0</td>
<td align="center">3.2</td>
<td align="center">4.7</td>
<td align="center">1.4</td>
<td align="center">5.0</td>
</tr>
<tr>
<td align="center">6.4</td>
<td align="center">3.2</td>
<td align="center">4.5</td>
<td align="center">1.5</td>
<td align="center">5.0</td>
</tr>
<tr>
<td align="center">5.1</td>
<td align="center">3.5</td>
<td align="center">1.4</td>
<td align="center">0.2</td>
<td align="center">2.5</td>
</tr>
<tr>
<td align="center">5.3</td>
<td align="center">3.7</td>
<td align="center">1.5</td>
<td align="center">0.2</td>
<td align="center">0.9</td>
</tr>
<tr>
<td align="center">5.0</td>
<td align="center">3.3</td>
<td align="center">1.4</td>
<td align="center">0.2</td>
<td align="center">0.9</td>
</tr>
</tbody></table>
<p>Form this chart, we may easily discover that if the value of
feature L1,L3 and L4 is high, the output of the chemical 
can also be relatively high. If we want to maximize the 
output of the chemical, we may attempt to make the feature
L1 of the flowers higher by fertilizer or other means. But
this will not help since the output of the chemical 
depends largely on the species rather than the features.
Because we misunderstand association as causation, our plan
will go in vain.</p>
<pre class=" language-mermaid"><code class=" language-mermaid" data-processed="true"><svg id="mermaid-1632534169674" width="100%" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" height="151.3333282470703" style="max-width: 151.3333282470703px;" viewBox="0 0 151.3333282470703 151.3333282470703"><style>#mermaid-1632534169674{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;fill:#333;}#mermaid-1632534169674 .error-icon{fill:#552222;}#mermaid-1632534169674 .error-text{fill:#552222;stroke:#552222;}#mermaid-1632534169674 .edge-thickness-normal{stroke-width:2px;}#mermaid-1632534169674 .edge-thickness-thick{stroke-width:3.5px;}#mermaid-1632534169674 .edge-pattern-solid{stroke-dasharray:0;}#mermaid-1632534169674 .edge-pattern-dashed{stroke-dasharray:3;}#mermaid-1632534169674 .edge-pattern-dotted{stroke-dasharray:2;}#mermaid-1632534169674 .marker{fill:#333333;}#mermaid-1632534169674 .marker.cross{stroke:#333333;}#mermaid-1632534169674 svg{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;}#mermaid-1632534169674 .label{font-family:"trebuchet ms",verdana,arial,sans-serif;color:#333;}#mermaid-1632534169674 .label text{fill:#333;}#mermaid-1632534169674 .node rect,#mermaid-1632534169674 .node circle,#mermaid-1632534169674 .node ellipse,#mermaid-1632534169674 .node polygon,#mermaid-1632534169674 .node path{fill:#ECECFF;stroke:#9370DB;stroke-width:1px;}#mermaid-1632534169674 .node .label{text-align:center;}#mermaid-1632534169674 .node.clickable{cursor:pointer;}#mermaid-1632534169674 .arrowheadPath{fill:#333333;}#mermaid-1632534169674 .edgePath .path{stroke:#333333;stroke-width:1.5px;}#mermaid-1632534169674 .flowchart-link{stroke:#333333;fill:none;}#mermaid-1632534169674 .edgeLabel{background-color:#e8e8e8;text-align:center;}#mermaid-1632534169674 .edgeLabel rect{opacity:0.5;background-color:#e8e8e8;fill:#e8e8e8;}#mermaid-1632534169674 .cluster rect{fill:#ffffde;stroke:#aaaa33;stroke-width:1px;}#mermaid-1632534169674 .cluster text{fill:#333;}#mermaid-1632534169674 div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:12px;background:hsl(80,100%,96.2745098039%);border:1px solid #aaaa33;border-radius:2px;pointer-events:none;z-index:100;}#mermaid-1632534169674:root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif;}#mermaid-1632534169674 flowchart{fill:apa;}</style><g><g class="output"><g class="clusters"></g><g class="edgePaths"><g class="edgePath LS-A LE-C" id="L-A-C" style="opacity: 1;"><path class="path" d="M60.581722823353026,44.41827908399561L29.33333396911621,75.66666793823242L29.33333396911621,100.66666793823242" marker-end="url(#arrowhead148)" style="fill:none"></path><defs><marker id="arrowhead148" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-A LE-B" id="L-A-B" style="opacity: 1;"><path class="path" d="M90.75161305311183,44.41827908399561L122.00000190734863,75.66666793823242L122.00000190734863,100.66666793823242" marker-end="url(#arrowhead149)" style="fill:none"></path><defs><marker id="arrowhead149" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g></g><g class="edgeLabels"><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-A-C" class="edgeLabel L-LS-A' L-LE-C"></span></div></foreignObject></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-A-B" class="edgeLabel L-LS-A' L-LE-B"></span></div></foreignObject></g></g></g><g class="nodes"><g class="node default" id="flowchart-A-99" transform="translate(75.66666793823242,29.33333396911621)" style="opacity: 1;"><circle x="-15.411458492279053" y="-21.33333396911621" r="21.33333396911621" class="label-container"></circle><g class="label" transform="translate(0,0)"><g transform="translate(-5.411458492279053,-11.333333969116211)"><foreignObject width="10.822916984558105" height="22.666667938232422"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">G</div></foreignObject></g></g></g><g class="node default" id="flowchart-B-100" transform="translate(122.00000190734863,122.00000190734863)" style="opacity: 1;"><circle x="-15.390625" y="-21.33333396911621" r="21.33333396911621" class="label-container"></circle><g class="label" transform="translate(0,0)"><g transform="translate(-5.390625,-11.333333969116211)"><foreignObject width="10.78125" height="22.666667938232422"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">O</div></foreignObject></g></g></g><g class="node default" id="flowchart-C-101" transform="translate(29.33333396911621,122.00000190734863)" style="opacity: 1;"><circle x="-14.203125" y="-21.33333396911621" r="21.33333396911621" class="label-container"></circle><g class="label" transform="translate(0,0)"><g transform="translate(-4.203125,-11.333333969116211)"><foreignObject width="8.40625" height="22.666667938232422"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">F</div></foreignObject></g></g></g></g></g></g></svg></code></pre>
<p><font size="2">(O: the output of the chemical)</font></p>
<p><font size="2">(Real situation: Gene control both the features and the output of the chemical)</font></p>
<pre class=" language-mermaid"><code class=" language-mermaid" data-processed="true"><svg id="mermaid-1632534169684" width="100%" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" height="58.66666793823242" style="max-width: 151.3333282470703px;" viewBox="0 0 151.3333282470703 58.66666793823242"><style>#mermaid-1632534169684{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;fill:#333;}#mermaid-1632534169684 .error-icon{fill:#552222;}#mermaid-1632534169684 .error-text{fill:#552222;stroke:#552222;}#mermaid-1632534169684 .edge-thickness-normal{stroke-width:2px;}#mermaid-1632534169684 .edge-thickness-thick{stroke-width:3.5px;}#mermaid-1632534169684 .edge-pattern-solid{stroke-dasharray:0;}#mermaid-1632534169684 .edge-pattern-dashed{stroke-dasharray:3;}#mermaid-1632534169684 .edge-pattern-dotted{stroke-dasharray:2;}#mermaid-1632534169684 .marker{fill:#333333;}#mermaid-1632534169684 .marker.cross{stroke:#333333;}#mermaid-1632534169684 svg{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;}#mermaid-1632534169684 .label{font-family:"trebuchet ms",verdana,arial,sans-serif;color:#333;}#mermaid-1632534169684 .label text{fill:#333;}#mermaid-1632534169684 .node rect,#mermaid-1632534169684 .node circle,#mermaid-1632534169684 .node ellipse,#mermaid-1632534169684 .node polygon,#mermaid-1632534169684 .node path{fill:#ECECFF;stroke:#9370DB;stroke-width:1px;}#mermaid-1632534169684 .node .label{text-align:center;}#mermaid-1632534169684 .node.clickable{cursor:pointer;}#mermaid-1632534169684 .arrowheadPath{fill:#333333;}#mermaid-1632534169684 .edgePath .path{stroke:#333333;stroke-width:1.5px;}#mermaid-1632534169684 .flowchart-link{stroke:#333333;fill:none;}#mermaid-1632534169684 .edgeLabel{background-color:#e8e8e8;text-align:center;}#mermaid-1632534169684 .edgeLabel rect{opacity:0.5;background-color:#e8e8e8;fill:#e8e8e8;}#mermaid-1632534169684 .cluster rect{fill:#ffffde;stroke:#aaaa33;stroke-width:1px;}#mermaid-1632534169684 .cluster text{fill:#333;}#mermaid-1632534169684 div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:12px;background:hsl(80,100%,96.2745098039%);border:1px solid #aaaa33;border-radius:2px;pointer-events:none;z-index:100;}#mermaid-1632534169684:root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif;}#mermaid-1632534169684 flowchart{fill:apa;}</style><g><g class="output"><g class="clusters"></g><g class="edgePaths"><g class="edgePath LS-B LE-A" id="L-B-A" style="opacity: 1;"><path class="path" d="M50.66666793823242,29.33333396911621L75.66666793823242,29.33333396911621L100.66666793823242,29.33333396911621" marker-end="url(#arrowhead156)" style="fill:none"></path><defs><marker id="arrowhead156" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g></g><g class="edgeLabels"><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-B-A" class="edgeLabel L-LS-B' L-LE-A"></span></div></foreignObject></g></g></g><g class="nodes"><g class="node default" id="flowchart-A-110" transform="translate(122.00000190734863,29.33333396911621)" style="opacity: 1;"><circle x="-15.390625" y="-21.33333396911621" r="21.33333396911621" class="label-container"></circle><g class="label" transform="translate(0,0)"><g transform="translate(-5.390625,-11.333333969116211)"><foreignObject width="10.78125" height="22.666667938232422"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">O</div></foreignObject></g></g></g><g class="node default" id="flowchart-B-111" transform="translate(29.33333396911621,29.33333396911621)" style="opacity: 1;"><circle x="-14.203125" y="-21.33333396911621" r="21.33333396911621" class="label-container"></circle><g class="label" transform="translate(0,0)"><g transform="translate(-4.203125,-11.333333969116211)"><foreignObject width="8.40625" height="22.666667938232422"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">F</div></foreignObject></g></g></g></g></g></g></svg></code></pre>
<p><font size="2">(Ostensible situation: features have causal effect on the output of the chemical)</font></p>
</div><script src="https://cdnjs.cloudflare.com/ajax/libs/mermaid/8.8.4/mermaid.min.js"></script><script type="text/javascript">
              ;(() => {
                var timeout = setInterval(() => {
                  if (!!(window.mermaid && mermaid.init)) {
                    clearInterval(timeout)
                    mermaid.init({}, 'code.language-mmd, code.language-mermaid')
                  }
                }, 50)
              })()
            </script><div class="mermaidTooltip" style="opacity: 0;"></div></body></html>
